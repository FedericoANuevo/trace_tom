pro merge_trace


  dir_fl  = '/data1/DATA/fieldlines_judit/'
  fl_list = 'list.txt'

  ; Read the list with the field-lines  
  N=0
  filename=''
  openr,1,dir_fl+fl_list
  readf,1,N_fl
  for i_fl = 0,N_fl-1 do begin
     readf,1,filename
     file_aia = filename+'_aia.out'
     file_mk4 = filename+'_mk4.out'
     file_c2  = filename+'_lascoc2.out'
     outfile  = filename+'_merge.out'
     readcol,dir_fl+file_aia,x_l,y_l,z_l,rad_l,lat_l,lon_l,Ne_l,Tm_l,index1_l,FORMAT='D,D,D,D,D,D'
     readcol,dir_fl+file_mk4,x_l,y_l,z_l,rad_l,lat_l,lon_l,Ne_mk4_l ,index2_l,FORMAT='D,D,D,D,D,D'
     readcol,dir_fl+file_c2 ,x_l,y_l,z_l,rad_l,lat_l,lon_l,Ne_c2_l  ,index3_l,FORMAT='D,D,D,D,D,D'
     N = n_elements(x_l)
     ; Write output file
     openw,2,dir_fl+outfile
     printf,2,'  X [Rs]            Y [Rs]            Z [Rs]            RAD [Rs]          LAT [deg]         LON [deg]         Ne [DEMT, cm^-3]  Te [DEMT, K]     DEMT-3Dind   Ne [Mk4, cm^ -3]    Mk4-3Dind  Ne [C2, cm^ -3]      C2-3Dind'
     for i = 0,N-1 do begin
        printf,2,x_l(i),y_l(i),z_l(i),rad_l(i),lat_l(i), lon_l(i), Ne_l(i),Tm_l(i),index1_l(i),Ne_mk4_l(i),index2_l(i),Ne_c2_l(i),index3_l(i),$
               FORMAT = '(8(E18.10)," ",I9,"  ",E18.10,"  ",I9,"  ",E18.10,"  ",I9)' 
     endfor
     close,2
  endfor
     close,1


  
  
  return
end
